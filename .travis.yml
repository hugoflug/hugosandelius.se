language: generic
sudo: required
services:
  - docker
before_script:
  - docker login -u hugosandelius -p $DOCKERHUB_PASSWD
  - docker-compose pull
script:
  - docker build nginx --cache-from hugosandelius/hugosandelius.se -t hugosandelius/hugosandelius.se:nginx
  - docker build hatify --cache-from hugosandelius/hugosandelius.se -t hugosandelius/hugosandelius.se:hatify
  - docker build tagga --cache-from hugosandelius/hugosandelius.se -t hugosandelius/hugosandelius.se:tagga
  - docker-compose push
deploy:
  # TODO: ssh key stuff
  #- scp docker-compose.yml root@hugosandelius.se:~ && ssh 'docker-compose up -d'